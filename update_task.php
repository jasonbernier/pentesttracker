<?php
require 'db.php';
session_start();

if (!isset($_SESSION['loggedin']) || !isset($_GET['task_id'])) {
    header('Location: index.php');
    exit;
}

if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST['status'])) {
    $status = $_POST['status'];
    $task_id = $_GET['task_id'];

    $stmt = $pdo->prepare("UPDATE User_Tasks SET status = ? WHERE task_id = ?");
    if ($stmt->execute([$status, $task_id])) {
        echo "Task status updated successfully.";
    } else {
        echo "Error updating task status.";
    }
    echo "<br><a href='index.php'>Back to Dashboard</a>";
} else {
    echo "<form action='' method='post'>
            <label for='status'>Update Status:</label>
            <select name='status'>
                <option value='in progress'>In Progress</option>
                <option value='completed'>Completed</option>
            </select>
            <input type='submit' value='Update'>
          </form>";
}
?>